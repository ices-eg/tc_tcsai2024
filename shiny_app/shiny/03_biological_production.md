report_03_biological_production.R
================
colin
2024-03-08

``` r
################################################################################
## 1  Mortality

Amax <- 15
age <- 1:Amax
Ninit <- 1000
Nvec <- numeric(Amax)
M <- rep(0.2, Amax)
Fmort <- c(0, 0, rep(0.3, Amax - 2))

Nvec[1] <- Ninit
for (a in 1:(Amax - 1)) {
  Nvec[a + 1] <- Nvec[a] * exp(-M[a] - Fmort[a])
}


data.frame(age, Nvec, M, Fmort)
```

    ##    age        Nvec   M Fmort
    ## 1    1 1000.000000 0.2   0.0
    ## 2    2  818.730753 0.2   0.0
    ## 3    3  670.320046 0.2   0.3
    ## 4    4  406.569660 0.2   0.3
    ## 5    5  246.596964 0.2   0.3
    ## 6    6  149.568619 0.2   0.3
    ## 7    7   90.717953 0.2   0.3
    ## 8    8   55.023220 0.2   0.3
    ## 9    9   33.373270 0.2   0.3
    ## 10  10   20.241911 0.2   0.3
    ## 11  11   12.277340 0.2   0.3
    ## 12  12    7.446583 0.2   0.3
    ## 13  13    4.516581 0.2   0.3
    ## 14  14    2.739445 0.2   0.3
    ## 15  15    1.661557 0.2   0.3

``` r
################################################################################
## 2  Growth

Winf <- 10
k <- 0.5
t0 <- -0.1
b <- 3

w <- Winf * (1 - exp(-k * (age - t0)))^b
B <- Nvec * w

data.frame(age, Nvec, w, B)
```

    ##    age        Nvec         w          B
    ## 1    1 1000.000000 0.7571391  757.13911
    ## 2    2  818.730753 2.7470391 2249.08540
    ## 3    3  670.320046 4.8884208 3276.80648
    ## 4    4  406.569660 6.6137983 2688.96974
    ## 5    5  246.596964 7.8356920 1932.25785
    ## 6    6  149.568619 8.6454561 1293.08893
    ## 7    7   90.717953 9.1627769  831.22837
    ## 8    8   55.023220 9.4863821  521.97129
    ## 9    9   33.373270 9.6863220  323.26424
    ## 10  10   20.241911 9.8089498  198.55189
    ## 11  11   12.277340 9.8838291  121.34713
    ## 12  12    7.446583 9.9294308   73.94033
    ## 13  13    4.516581 9.9571579   44.97231
    ## 14  14    2.739445 9.9740003   27.32322
    ## 15  15    1.661557 9.9842250   16.58936

``` r
sum(B)
```

    ## [1] 14356.54

``` r
################################################################################
## 3  Recruitment

mat <- c(0, 0, rep(1, Amax - 2))
SSBvec <- B * mat
sum(SSBvec)
```

    ## [1] 11350.31

``` r
alpha <- 1000
beta <- 1000
Tmax <- 25
year <- 1:Tmax

N <- matrix(nrow = Amax, ncol = Tmax)
SSB <- matrix(nrow = Amax, ncol = Tmax)

N[, 1] <- Nvec
SSB[, 1] <- N[, 1] * mat * w

N[1, 2] <- (alpha * sum(SSB[, 1])) / (beta + sum(SSB[, 1]))
for (a in 1:(Amax - 1)) {
  N[a + 1, 2] <- N[a, 1] * exp(-M[a] - Fmort[a])
}
SSB[, 2] <- N[, 2] * mat * w

for (t in 1:(Tmax - 1))
{
  N[1, t + 1] <- (alpha * sum(SSB[, t])) / (beta + sum(SSB[, t]))
  for (a in 1:(Amax - 1)) {
    N[a + 1, t + 1] <- N[a, t] * exp(-M[a] - Fmort[a])
  }
  SSB[, t + 1] <- N[, t + 1] * mat * w
}

round(N)
```

    ##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
    ##  [1,] 1000  919  919  919  917  916  915  914  913   913   913   912   912   912   912   912   912   912   912   912   912   912   912   912   912
    ##  [2,]  819  819  752  752  752  751  750  749  748   748   747   747   747   747   747   747   747   747   747   747   747   747   747   747   747
    ##  [3,]  670  670  670  616  616  616  615  614  613   613   612   612   612   612   611   611   611   611   611   611   611   611   611   611   611
    ##  [4,]  407  407  407  407  374  374  374  373  372   372   372   371   371   371   371   371   371   371   371   371   371   371   371   371   371
    ##  [5,]  247  247  247  247  247  227  227  227  226   226   226   225   225   225   225   225   225   225   225   225   225   225   225   225   225
    ##  [6,]  150  150  150  150  150  150  137  137  137   137   137   137   137   137   137   136   136   136   136   136   136   136   136   136   136
    ##  [7,]   91   91   91   91   91   91   91   83   83    83    83    83    83    83    83    83    83    83    83    83    83    83    83    83    83
    ##  [8,]   55   55   55   55   55   55   55   55   51    51    51    50    50    50    50    50    50    50    50    50    50    50    50    50    50
    ##  [9,]   33   33   33   33   33   33   33   33   33    31    31    31    31    31    31    30    30    30    30    30    30    30    30    30    30
    ## [10,]   20   20   20   20   20   20   20   20   20    20    19    19    19    19    19    19    18    18    18    18    18    18    18    18    18
    ## [11,]   12   12   12   12   12   12   12   12   12    12    12    11    11    11    11    11    11    11    11    11    11    11    11    11    11
    ## [12,]    7    7    7    7    7    7    7    7    7     7     7     7     7     7     7     7     7     7     7     7     7     7     7     7     7
    ## [13,]    5    5    5    5    5    5    5    5    5     5     5     5     5     4     4     4     4     4     4     4     4     4     4     4     4
    ## [14,]    3    3    3    3    3    3    3    3    3     3     3     3     3     3     3     3     3     3     3     3     3     3     3     2     2
    ## [15,]    2    2    2    2    2    2    2    2    2     2     2     2     2     2     2     2     2     2     2     2     2     2     2     2     2

``` r
rec_age <- 1
SR <-
  data.frame(
    year = year[1:(Tmax - rec_age)],
    SSB = colSums(SSB)[1:(Tmax - rec_age)],
    Rec = N[1, (rec_age + 1):Tmax]
  )

SSB.curve <- seq(0, 12000, by = 500)
Rec.curve <- (alpha * SSB.curve) / (beta + SSB.curve)

par(mfrow = c(2, 1), oma = c(0, 0, 0, 3))
plot(SR$year, SR$SSB,
  ylim = c(0, 12000), type = "l", lwd = 2, col = "blue", xlab = "Year",
  ylab = "SSB (t)"
)
lines(SR$year, SR$Rec * 10, lwd = 2, col = "red")
axis(4, at = seq(0, 12000, by = 2000), labels = seq(0, 1200, by = 200))
mtext("Recruitment at age 1 (1000s)", side = 4, line = 3)

plot(SSB.curve, Rec.curve,
  ylim = c(0, 1000), type = "l", xlab = "SSB (t)",
  ylab = "Recruitment at age 1 (1000s)", lwd = 2, col = "red"
)
points(SR$SSB, SR$Rec, type = "o", pch = 16, col = "blue")
```

![](03_biological_production/unnamed-chunk-1-1.png)<!-- -->

``` r
data.frame(SSB.curve, Rec.curve)
```

    ##    SSB.curve Rec.curve
    ## 1          0    0.0000
    ## 2        500  333.3333
    ## 3       1000  500.0000
    ## 4       1500  600.0000
    ## 5       2000  666.6667
    ## 6       2500  714.2857
    ## 7       3000  750.0000
    ## 8       3500  777.7778
    ## 9       4000  800.0000
    ## 10      4500  818.1818
    ## 11      5000  833.3333
    ## 12      5500  846.1538
    ## 13      6000  857.1429
    ## 14      6500  866.6667
    ## 15      7000  875.0000
    ## 16      7500  882.3529
    ## 17      8000  888.8889
    ## 18      8500  894.7368
    ## 19      9000  900.0000
    ## 20      9500  904.7619
    ## 21     10000  909.0909
    ## 22     10500  913.0435
    ## 23     11000  916.6667
    ## 24     11500  920.0000
    ## 25     12000  923.0769

``` r
################################################################################
## 4  Recruitment variability

v <- 1000

## Year 1
N[, 1] <- Nvec
SSB[, 1] <- N[, 1] * mat * w

## Later years
for (t in 1:(Tmax - 1))
{
  N[1, t + 1] <- (alpha * sum(SSB[, t])) / (beta + sum(SSB[, t])) + v * runif(1, -0.5, 0.5)
  for (a in 1:(Amax - 1)) {
    N[a + 1, t + 1] <- N[a, t] * exp(-M[a] - Fmort[a])
  }
  SSB[, t + 1] <- N[, t + 1] * mat * w
}

round(N, 3)
```

    ##           [,1]    [,2]    [,3]     [,4]     [,5]    [,6]    [,7]    [,8]    [,9]    [,10]   [,11]   [,12]   [,13]   [,14]   [,15]   [,16]   [,17]   [,18]   [,19]    [,20]
    ##  [1,] 1000.000 723.249 624.275 1400.416  932.260 829.799 670.581 718.216 545.972 1206.287 961.696 826.510 587.082 996.150 878.471 759.029 610.731 433.938 631.343 1000.254
    ##  [2,]  818.731 818.731 592.146  511.113 1146.564 763.270 679.382 549.025 588.025  447.004 987.624 787.370 676.689 480.662 815.579 719.231 621.441 500.024 355.278  516.900
    ##  [3,]  670.320 670.320 670.320  484.809  418.464 938.727 624.913 556.231 449.504  481.434 365.976 808.598 644.644 554.026 393.533 667.740 588.857 508.793 409.385  290.877
    ##  [4,]  406.570 406.570 406.570  406.570  294.051 253.811 569.367 379.029 337.371  272.638 292.005 221.976 490.440 390.996 336.034 238.690 405.005 357.160 308.598  248.305
    ##  [5,]  246.597 246.597 246.597  246.597  246.597 178.351 153.944 345.338 229.893  204.626 165.363 177.110 134.635 297.467 237.151 203.815 144.773 245.648 216.628  187.174
    ##  [6,]  149.569 149.569 149.569  149.569  149.569 149.569 108.175  93.372 209.458  139.437 124.112 100.298 107.423  81.660 180.423 143.840 123.620  87.809 148.993  131.392
    ##  [7,]   90.718  90.718  90.718   90.718   90.718  90.718  90.718  65.612  56.633  127.043  84.573  75.278  60.834  65.155  49.529 109.432  87.243  74.979  53.259   90.369
    ##  [8,]   55.023  55.023  55.023   55.023   55.023  55.023  55.023  55.023  39.796   34.350  77.055  51.296  45.658  36.898  39.519  30.041  66.374  52.916  45.477   32.303
    ##  [9,]   33.373  33.373  33.373   33.373   33.373  33.373  33.373  33.373  33.373   24.137  20.834  46.736  31.113  27.693  22.379  23.969  18.221  40.258  32.095   27.583
    ## [10,]   20.242  20.242  20.242   20.242   20.242  20.242  20.242  20.242  20.242   20.242  14.640  12.637  28.347  18.871  16.797  13.574  14.538  11.052  24.418   19.467
    ## [11,]   12.277  12.277  12.277   12.277   12.277  12.277  12.277  12.277  12.277   12.277  12.277   8.880   7.664  17.193  11.446  10.188   8.233   8.818   6.703   14.810
    ## [12,]    7.447   7.447   7.447    7.447    7.447   7.447   7.447   7.447   7.447    7.447   7.447   7.447   5.386   4.649  10.428   6.942   6.179   4.994   5.348    4.066
    ## [13,]    4.517   4.517   4.517    4.517    4.517   4.517   4.517   4.517   4.517    4.517   4.517   4.517   4.517   3.267   2.820   6.325   4.211   3.748   3.029    3.244
    ## [14,]    2.739   2.739   2.739    2.739    2.739   2.739   2.739   2.739   2.739    2.739   2.739   2.739   2.739   2.739   1.981   1.710   3.836   2.554   2.273    1.837
    ## [15,]    1.662   1.662   1.662    1.662    1.662   1.662   1.662   1.662   1.662    1.662   1.662   1.662   1.662   1.662   1.662   1.202   1.037   2.327   1.549    1.379
    ##         [,21]    [,22]    [,23]    [,24]    [,25]
    ##  [1,] 802.892 1172.019 1251.231  511.313 1309.969
    ##  [2,] 818.938  657.352  959.568 1024.421  418.628
    ##  [3,] 423.202  670.490  538.195  785.628  838.725
    ##  [4,] 176.426  256.685  406.673  326.432  476.507
    ##  [5,] 150.604  107.008  155.687  246.660  197.991
    ##  [6,] 113.527   91.346   64.903   94.429  149.607
    ##  [7,]  79.693   68.858   55.404   39.366   57.274
    ##  [8,]  54.811   48.336   41.764   33.604   23.877
    ##  [9,]  19.593   33.245   29.317   25.331   20.382
    ## [10,]  16.730   11.884   20.164   17.782   15.364
    ## [11,]  11.807   10.147    7.208   12.230   10.785
    ## [12,]   8.983    7.161    6.155    4.372    7.418
    ## [13,]   2.466    5.448    4.344    3.733    2.652
    ## [14,]   1.968    1.496    3.305    2.635    2.264
    ## [15,]   1.114    1.193    0.907    2.004    1.598

``` r
rec_age <- 1
SR <-
  data.frame(
    year = year[1:(Tmax - rec_age)],
    SSB = colSums(SSB)[1:(Tmax - rec_age)],
    Rec = N[1, (rec_age + 1):Tmax]
  )

SSB.curve <- seq(0, 15000, by = 500)
Rec.curve <- (alpha * SSB.curve) / (beta + SSB.curve)

plot(SR$year, SR$SSB,
  ylim = c(0, 15000), type = "l", lwd = 2, col = "blue", xlab = "Year",
  ylab = "SSB (t)"
)
lines(SR$year, SR$Rec * 10, lwd = 2, col = "red")
axis(4, at = seq(0, 12000, by = 2000), labels = seq(0, 1200, by = 200))
mtext("Recruitment at age 1 (1000s)", side = 4, line = 3)

plot(SSB.curve, Rec.curve,
  xlim = c(0, 15000), ylim = c(0, 1500), type = "l",
  xlab = "SSB (t)", ylab = "Recruitment at age 1 (1000s)", lwd = 2, col = "red"
)
points(SR$SSB, SR$Rec, type = "o", pch = 16, col = "blue")
```

![](03_biological_production/unnamed-chunk-1-2.png)<!-- -->
